<script>
$(document).ready(function() {
    var rawMsg = "{% if messages %}{% for message in messages %}{{ message }}{% endfor %}{% else %}None{% endif %}";
    var definedOpenTab = false;

    if (rawMsg != "None") {
        var decodeMe = document.createElement('textarea');
        decodeMe.innerHTML = rawMsg;
        var decoded = decodeMe.value;

        // Parse the message:
        var elemList = decoded.split(";");

        for (var i in elemList) {
            var elems = elemList[i].split("=");

            switch (elems[0]) {
                case "open_tab":
                    if (elems[1] == "viewBadges") {
                        console.log('elems[1] is viewBadges');
                        break;
                    }

                    console.log(elems[1])

                    // Re-open a tab:
                    definedOpenTab = true;

                    if (elems[1] == "manageInvites" || elems[1] == "manageApplications") {
                        $($('a[href="\#manageMembers"]')[0]).removeClass('active');

                        // Make "Manage Users" active first:
                        $($('a[href="\#manageUsers"]')[0]).trigger('click');
                    }

                    if (elems[1] == "manageMembers") {
                        $($('a[href="\#manageUsers"]')[0]).trigger('click');
                    }

                    $($('a[href="\#' + elems[1] + '"]')[0]).trigger('click');
                    break;
                case "return_msg":
                    // Display a message:
                    $('#message').html(elems[1]);
                    $('.message-container').css('visibility', 'visible');
                    $('.message-container').css('opacity', '1');

                    // Hide the message after a few seconds:
                    setTimeout(function() {
                        $('.message-container').css('opacity', 0);
                        setTimeout(function() {
                            $('.message-container').css('visibility', 'hidden');
                        }, 500);
                    }, 5000);

                    break;
                default:
                    break;
            }
        }
    }

    // If open tab is not specified, go to the default:
    if (!definedOpenTab) {
        $('#viewBadges').addClass('active');
        $($('a[href="\#viewBadges"]')[0]).trigger('click');
        console.log('made viewBadges visible');
    }
})
</script>
<div class="container" style="padding-top: 70px;">
    <div class="row">
        <div class="col-xs-6 col-sm-8">
            <h1 style="margin-bottom: 0px;">{{ community.name }}
            </h1>
        </div>
        <div class="col-xs-6 col-sm-4">
            {% block navpills %}
            {% endblock %}
        </div>
    </div>

    <hr>

    <div class="container">
        <div class="tab-content">
            {% block badges %}
            {% endblock %}

            {% block members %}
            {% endblock %}

            <div id="aboutCommunity" class="tab-pane fade in {% if not is_member %}active{% endif %}">
                <div class="row">
                    <div class="col-sm-6">
                        <h3 style="margin-top: 0px;">
                            Description
                            {% block editdescriptionglyph %}
                            {% endblock %}
                        </h3>
                        <div id="originalDescription">
                            {{ community.description|linebreaksbr }}
                        </div>
                        {% block editdescriptionform %}
                        {% endblock %}
                    </div>
                    <hr class="visible-xs">
                    <div class="col-sm-3">
                        <h3 style="margin-top: 0px;">
                            Is private
                            {% block editprivacyglyph %}
                            {% endblock %}
                        </h3>
                        <div id="originalPrivacy">
                        {{ community.is_private }}
                        </div>
                        {% block editprivacyform %}
                        {% endblock %}
                    </div>
                    <hr class="visible-xs">
                    <div class="col-sm-3">
                        <h3 style="margin-top: 0px;">Created on</h3>
                        {{ community.created_on }}
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
{% block moderatorfooter %}
{% endblock %}
<div class="message-container">
    <div id="message"></div>
</div>